---
title: 多表查询
tags: []
categories: [MySQL]
date: 2023-05-23 16:37:13
---

## 多表查询

指从多张表中查询数据。

## 多表关系

- 一对多：在多的一方建立外键，指向一的一方的主键
- 多对多：建立第三张中间表，中间表至少包含两个外键，分别关联两方主键
- 一对一：在任意一方加入外键，关联另一方的主键，并且设置外键为唯一的（UNIQUE）。多用于单表拆分，将一张表的基础字段放在一张表中，其他详情字段放在另一张表中，以提升操作效率

## 多表查询分类

### 连接查询

- 内连接：查询两张表的交集部分数据。

隐式内连接：

```sql
    select * from employee e, department d where e.dept_id = d.id;
```

显式内连接：

```sql
    select * from employee e, inner join department d on e.dept_id = d.id;
```

- 外连接：

左外连接：查询左表所有数据，以及两张表的交集部分数据数据

```sql
    select * from employee e, left join department d on e.dept_id = d.id;
```

右外连接：查询右表所有数据，以及两张表的交集部分数据数据

```sql
    select * from employee e, right join department d on e.dept_id = d.id;
```

- 自连接：查询当前表和自身的连接查询，自连接必须使用别名。自连接可以是内连接，也可以是外连接

内连接：

```sql
    -- 查询员工及其所属领导的名字
    select emp.name, mng.name from employee emp, employee mng on emp.manager_id = mng.id;
```

外连接：

```sql
    -- 查询员工及其所属领导的名字，员工没有领导也要查询出来
    select emp.name, mng.name from employee emp left join employee mng on emp.manager_id = mng.id;
```

### 子查询